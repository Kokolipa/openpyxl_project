{"version":3,"file":"StylesheetContext.js","sourceRoot":"../src/","sources":["StylesheetContext.tsx"],"names":[],"mappings":";;AAAA,6BAA+B;AAG/B,IAAM,eAAe,GAAG,EAAE,QAAQ,EAAE,UAAU,EAAE,CAAC;AASjD;;;;GAIG;AACU,QAAA,cAAc,GAAG,UAAC,MAAqC,EAAE,OAA8B;IAC1F,IAAA,+BAAU,EAAE,uBAAM,CAAa;IACvC,IAAI,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;QAChC,OAAO;KACR;IAED,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;QAC1B,MAAM,GAAG,CAAC,MAAM,CAAC,CAAC;KACnB;IAED,gDAAgD;IAChD,IAAM,cAAc,GAAG,EAAE,CAAC;IAC1B,IAAM,QAAQ,GAAG,MAAM,IAAI,eAAe,CAAC;IAC3C,IAAI,iBAAiB,GAAG,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IAEjD,IAAI,CAAC,iBAAiB,EAAE;QACtB,iBAAiB,GAAG,IAAI,GAAG,EAAE,CAAC;QAC9B,UAAU,CAAC,GAAG,CAAC,QAAQ,EAAE,iBAAiB,CAAC,CAAC;KAC7C;IAED,KAAoB,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAM,EAAE;QAAvB,IAAM,KAAK,eAAA;QACd,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;YACjC,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAC3B,iBAAiB,CAAC,GAAG,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;SACpC;KACF;IAED,IAAI,cAAc,CAAC,MAAM,EAAE;QACzB,OAAO,CAAC,YAAY,CAAC,cAAc,EAAE,OAAO,CAAC,CAAC;KAC/C;AACH,CAAC,CAAC;AAEF;;;GAGG;AACH,IAAM,YAAY,GAAG,UAAC,MAAgB,EAAE,OAA8B;IAC5D,IAAA,uBAAM,CAAa;IAE3B,IAAI,MAAM,CAAC,MAAM,IAAI,MAAM,EAAE;QAC3B,IAAM,YAAY,GAAG,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;QAEnD,YAAY,CAAC,WAAW,GAAG,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAC3C,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC;KACvC;AACH,CAAC,CAAC;AAEF,sFAAsF;AACzE,QAAA,iBAAiB,GAAG,KAAK,CAAC,aAAa,CAAwB;IAC1E,cAAc,wBAAA;IACd,YAAY,cAAA;IACZ,MAAM,EAAE,OAAO,MAAM,KAAK,QAAQ,CAAC,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,SAAS;IAChE,UAAU,EAAE,IAAI,OAAO,EAA2D;CACnF,CAAC,CAAC","sourcesContent":["import * as React from 'react';\nexport type HTMLDirection = 'rtl' | 'ltr' | 'auto';\n\nconst defaultDocument = { document: 'document' };\n\nexport interface StylesheetContextType {\n  target: Document | undefined;\n  registerStyles: (stylesheets: undefined | string | string[], context: StylesheetContextType) => void;\n  styleCache: WeakMap<Document | typeof defaultDocument, Map<string, boolean>>;\n  renderStyles: (stylesheets: string[], context: StylesheetContextType) => void;\n}\n\n/**\n * Register styles can be called with a single or multiple stylesheets. Each will be evaluated\n * if they've been registered already, and then passed along to `renderStyles` if they're new\n * to the given context.\n */\nexport const registerStyles = (sheets: undefined | string | string[], context: StylesheetContextType) => {\n  const { styleCache, target } = context;\n  if (!sheets || sheets.length < 1) {\n    return;\n  }\n\n  if (!Array.isArray(sheets)) {\n    sheets = [sheets];\n  }\n\n  // Grab the style cache for the target document.\n  const sheetsToRender = [];\n  const cacheKey = target || defaultDocument;\n  let targetStylesheets = styleCache.get(cacheKey);\n\n  if (!targetStylesheets) {\n    targetStylesheets = new Map();\n    styleCache.set(cacheKey, targetStylesheets);\n  }\n\n  for (const sheet of sheets) {\n    if (!targetStylesheets.has(sheet)) {\n      sheetsToRender.push(sheet);\n      targetStylesheets.set(sheet, true);\n    }\n  }\n\n  if (sheetsToRender.length) {\n    context.renderStyles(sheetsToRender, context);\n  }\n};\n\n/**\n * Default renderStyles implementation, which will render the give sheets to the contextual\n * target.\n */\nconst renderStyles = (sheets: string[], context: StylesheetContextType) => {\n  const { target } = context;\n\n  if (sheets.length && target) {\n    const styleElement = target.createElement('style');\n\n    styleElement.textContent = sheets.join('');\n    target.head.appendChild(styleElement);\n  }\n};\n\n// Shared stylesheet context, providing the registration function and target document.\nexport const StylesheetContext = React.createContext<StylesheetContextType>({\n  registerStyles,\n  renderStyles,\n  target: typeof window === 'object' ? window.document : undefined,\n  styleCache: new WeakMap<Document | typeof defaultDocument, Map<string, boolean>>(),\n});\n"]}